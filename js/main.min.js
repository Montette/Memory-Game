let backTiles=[],tiles=[],images=['a','a','b','b','c','c','d','d','e','e','f','f'],imagesMedium=['a','a','b','b','c','c','d','d','e','e','f','f','g','g','h','h'],imagesHard=['a','a','b','b','c','c','d','d','e','e','f','f','g','g','h','h','i','i','j','j'],gameArray=[],activeTile=[],visibleTiles=[],pairs=0,score=0;const resetButton=document.querySelector('.button--resetGame'),mediumButton=document.querySelector('.button--mediumGame'),easyButton=document.querySelector('.button--easyGame'),hardButton=document.querySelector('.button--hardGame'),playAgainButton=document.querySelector('.button--playAgain'),pauseButton=document.querySelector('.button--pauseGame'),modal=document.querySelector('.modal'),resultText=document.querySelector('.modal__result'),resultInformation=document.querySelector('.modal__information'),container=document.querySelector('.container');let clicksCounter=0;const clicksCounterOutput=document.querySelector('.results__counter');let running=!1,time=0,timeResult='',secunds=0;const timeOutput=document.querySelector('.results__gameTime'),enableListener=()=>{let a=[...document.querySelectorAll('.card')],b=[...document.querySelectorAll('.card__face--back')].filter((a)=>!a.children[0].classList.contains('disabled'));b.forEach((a)=>{a.parentElement.addEventListener('click',clicked)})},increment=()=>{var a=Math.floor;!0==running&&setTimeout(function(){time++;let b=a(time/10/60),c=a(time/10%60),d=a(time/10/60/60);secunds=a(time/10),10>b&&(b='0'+b),10>c&&(c='0'+c),10>d&&(d='0'+d),timeResult=` ${d} : ${b} : ${c}`,timeOutput.innerHTML=timeResult,increment()},100)},startTimer=()=>{!1==running&&(running=!0,increment())},resetTimer=()=>{running=!1,time=0,timeOutput.innerText='00 : 00 : 00'},pauseTimer=()=>{pauseButton.classList.toggle('active'),running=!running,running?enableListener():tiles.forEach((a)=>a.removeEventListener('click',clicked)),increment()},resetGame=()=>{resetTimer(),pauseButton.classList.remove('active'),clicksCounter=0,clicksCounterOutput.innerHTML=clicksCounter,activeTile=[],visibleTiles=[],score=0,tiles.forEach((a)=>{a.classList.remove('is-flipped')}),backTiles.forEach((a)=>{a.className='card__face card__face--back',a.children[0].classList.remove('color')}),setTimeout(startGame,1e3)},clicked=(a)=>{clicksCounter++,clicksCounterOutput.innerHTML=clicksCounter;let b=a.currentTarget;if(b.removeEventListener('click',clicked),b.classList.add('is-flipped'),2<activeTile.length)return;visibleTiles.push(b.id);let c=b.lastElementChild;activeTile.push(c.className),2===activeTile.length&&(tiles.forEach((a)=>a.removeEventListener('click',clicked)),activeTile[0]==activeTile[1]?(score++,setTimeout(()=>{if(document.getElementById(visibleTiles[0]).children[1].children[0].classList.add('color'),document.getElementById(visibleTiles[0]).children[1].classList.add('disabled'),c.children[0].classList.add('color'),c.classList.add('disabled'),activeTile=[],visibleTiles=[],enableListener(),score==pairs){pauseTimer();let a={easyTime:'',easyTimeToDisplay:'',easyClicks:'',mediumTime:'',mediumTimeToDisplay:'',mediumClicks:'',hardTime:'',hardTimeToDisplay:'',hardClicks:''};6==pairs?(a.easyTime=secunds,a.easyTimeToDisplay=timeResult,a.easyClicks=clicksCounter):8==pairs?(a.mediumTime=secunds,a.mediumTimeToDisplay=timeResult,a.mediumClicks=clicksCounter):10==pairs&&(a.hardTime=secunds,a.hardTimeToDisplay=timeResult,a.hardClicks=clicksCounter),setTimeout(()=>{modal.classList.add('displayBlock');let b=JSON.parse(localStorage.getItem('myElement'));if(6==pairs){let c;if(null==b||''==b.easyTime){c='';localStorage.setItem('myElement',JSON.stringify(a))}else if(b.easyTime>secunds){c=`Gratulation, you beat your record in the easy level! Your previous record:${b.easyTimeToDisplay}`;localStorage.setItem('myElement',JSON.stringify(a))}else c=`You don't beat your record! Your best time in the easy level: ${b.easyTimeToDisplay}`;resultText.innerHTML=`You won! Your time: ${timeResult}, your clickes: ${clicksCounter}.`,resultInformation.innerHTML=c}else if(8==pairs){let c;if(null==b||''==b.mediumTime){c='';localStorage.setItem('myElement',JSON.stringify(a))}else if(b.mediumTime>secunds){c=`Gratulation, you beat your record in the medium level! Your previous record: ${b.mediumTimeToDisplay}`;localStorage.setItem('myElement',JSON.stringify(a))}else c=`You don't beat your record. Your best time in the medium level: ${b.mediumTimeToDisplay}`;resultText.innerHTML=`You won! Your time: ${timeResult}, your clickes: ${clicksCounter}.`,resultInformation.innerHTML=c}else if(10==pairs){let c;if(null==b||''==b.hardTime){c='';localStorage.setItem('myElement',JSON.stringify(a))}else if(b.hardTime>secunds){c=`Gratulation, you beat your record in the hard level! Your previous record: ${b.hardTimeToDisplay}`;localStorage.setItem('myElement',JSON.stringify(a))}else c=`You don't beat your record! Your best time in the hard level: ${b.hardTimeToDisplay}`;resultText.innerHTML=`You won! Your time: ${timeResult}, your clickes: ${clicksCounter}.`,resultInformation.innerHTML=c}},1e3)}},500)):setTimeout(()=>{document.getElementById(visibleTiles[0]).classList.remove('is-flipped'),b.classList.remove('is-flipped'),activeTile=[],visibleTiles=[],enableListener()},800))},startGame=()=>{let a=document.querySelectorAll('.card');tiles=[...a];let b=document.querySelectorAll('.card__face--back');backTiles=[...b],12===tiles.length?(gameArray=[...images],easyButton.classList.add('active')):16===tiles.length?gameArray=[...imagesMedium]:20===tiles.length&&(gameArray=[...imagesHard]),pairs=gameArray.length/2,tiles.forEach((a)=>{a.addEventListener('click',clicked)}),backTiles.forEach((a)=>{let b=Math.floor(Math.random()*gameArray.length);a.classList.add(gameArray[b]),gameArray.splice(b,1)}),startTimer()},mediumGame=()=>{let a=document.querySelectorAll('.scene');if(12===a.length)for(i=0;4>i;i++){let a=document.createElement('div');a.className='scene';let b=13+i;a.id=`scene${1+i}`,a.innerHTML=`
        
            <div class="card" id=${b}>
                <div class="card__face card__face--front">
                </div>
                <div class="card__face card__face--back">
                    <div class="layer"></div>
                </div>
            </div>
        `,container.appendChild(a)}else if(20===a.length)for(i=5;8>=i;i++){let a=`scene${i}`,b=document.getElementById(a);container.removeChild(b)}else if(16===a.length)return;resetGame(),mediumButton.classList.add('active'),easyButton.classList.remove('active'),hardButton.classList.remove('active')},hardGame=()=>{let a=0,b=0,c=0,d=document.querySelectorAll('.scene');if(12===d.length)c=8,a=13,b=1;else if(16===d.length)c=4,a=17,b=5;else if(20===d.length)return;for(i=0;i<c;i++){let c=document.createElement('div');c.className='scene';let d=a+i;c.id=`scene${b+i}`,c.innerHTML=`
            
                <div class="card" id=${d}>
                    <div class="card__face card__face--front">
                    </div>
                    <div class="card__face card__face--back">
                        <div class="layer"></div>
                    </div>
                </div>
            `,container.appendChild(c)}resetGame(),hardButton.classList.add('active'),easyButton.classList.remove('active'),mediumButton.classList.remove('active')},easyGame=()=>{let a=document.querySelectorAll('.scene'),b=0;if(16===a.length){b=1,idCounter=4;for(let a,b=1;4>=b;b++){a=`scene${b}`,console.log(a);let c=document.getElementById(a);container.removeChild(c)}}else if(20===a.length){b=17,idCounter=20;for(let a=1;8>=a;a++){let b=`scene${a}`,c=document.getElementById(b);container.removeChild(c)}}else return;resetGame(),easyButton.classList.add('active'),hardButton.classList.remove('active'),mediumButton.classList.remove('active')};resetButton.addEventListener('click',resetGame),mediumButton.addEventListener('click',mediumGame),easyButton.addEventListener('click',easyGame),hardButton.addEventListener('click',hardGame),pauseButton.addEventListener('click',pauseTimer),playAgainButton.addEventListener('click',()=>{modal.classList.remove('displayBlock'),resetGame()});